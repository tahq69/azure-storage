// Azure Storage JavaScript Client Library 0.2.6-preview.12 
// Copyright (c) Microsoft and contributors. All rights reserved. 
require=function e(t,s,r){function u(o,i){if(!s[o]){if(!t[o]){var a="function"==typeof require&&require;if(!i&&a)return a(o,!0);if(n)return n(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=s[o]={exports:{}};t[o][0].call(c.exports,function(e){var s=t[o][1][e];return u(s||e)},c,c.exports,e,t,s,r)}return s[o].exports}for(var n="function"==typeof require&&require,o=0;o<r.length;o++)u(r[o]);return u}({3:[function(e,t,s){var r=window.AzureStorage||{};r.generateDevelopmentStorageCredentials=function(e){var t="UseDevelopmentStorage=true;";return e&&(t+="DevelopmentStorageProxyUri="+e),t};var u=e("../lib/services/queue/queueservice");r.QueueService=u,r.QueueUtilities=e("../lib/services/queue/queueutilities"),r.QueueMessageEncoder=e("../lib/services/queue/queuemessageencoder"),r.createQueueService=function(e,t,s){return new u(e,t,s)},r.createQueueServiceWithSas=function(e,t){return new u(null,null,e,t)};var n=e("../lib/common/common.browser"),o=n.StorageServiceClient,i=n.SharedKey;r.generateAccountSharedAccessSignature=function(e,t,s){var r=o.getStorageSettings(e,t);return new i(r._name,r._key).generateAccountSignedQueryString(s)},r.Constants=n.Constants,r.StorageUtilities=n.StorageUtilities,r.AccessCondition=n.AccessCondition,r.SR=n.SR,r.StorageServiceClient=o,r.Logger=n.Logger,r.WebResource=n.WebResource,r.Validate=n.validate,r.date=n.date,r.LinearRetryPolicyFilter=n.LinearRetryPolicyFilter,r.ExponentialRetryPolicyFilter=n.ExponentialRetryPolicyFilter,r.RetryPolicyFilter=n.RetryPolicyFilter,window.AzureStorage=r},{"../lib/common/common.browser":5,"../lib/services/queue/queuemessageencoder":59,"../lib/services/queue/queueservice":60,"../lib/services/queue/queueutilities":61}],61:[function(e,t,s){t.exports;var r={SharedAccessPermissions:{READ:"r",ADD:"a",UPDATE:"u",PROCESS:"p"}};t.exports=r},{}],60:[function(e,t,s){(function(s){function r(e,t,s,u,n){var o=p.getStorageSettings(e,t,s,u,n);if(r.super_.call(this,o._name,o._key,o._queueEndpoint,o._usePathStyleUri,o._sasToken),this.anonymous)throw new Error(l.ANONYMOUS_ACCESS_BLOBSERVICE_ONLY);this.messageEncoder=new y.TextXmlQueueMessageEncoder}var u=e("util"),n=e("underscore"),o=e("extend"),i=e("./../../common/common.core"),a=i.util,l=i.SR,c=i.validate,p=i.StorageServiceClient,g=i.WebResource,d=i.Constants,f=d.QueryStringConstants,m=d.HeaderConstants,v=d.RequestLocationMode,E=e("./models/queueresult"),q=i.AclResult,R=e("./models/queuemessageresult"),y=e("./queuemessageencoder"),h=i.ServiceStatsParser;u.inherits(r,p),r.prototype.getServiceStats=function(e,t){var s;a.normalizeArgs(e,t,function(e,r){s=e,t=r}),c.validateArgs("getServiceStats",function(e){e.callback(t)});var r=o(!0,{},s),u=g.get().withQueryOption(f.COMP,"stats").withQueryOption(f.RESTYPE,"service");r.requestLocationMode=v.PRIMARY_OR_SECONDARY;this.performRequest(u,null,r,function(e,s){e.serviceStatsResult=null,e.error||(e.serviceStatsResult=h.parse(e.response.body.StorageServiceStats));s(e,function(e){t(e.error,e.serviceStatsResult,e.response)})})},r.prototype.getServiceProperties=function(e,t){return this.getAccountServiceProperties(e,t)},r.prototype.setServiceProperties=function(e,t,s){return this.setAccountServiceProperties(e,t,s)},r.prototype.listQueuesSegmented=function(e,t,s){this.listQueuesSegmentedWithPrefix(null,e,t,s)},r.prototype.listQueuesSegmentedWithPrefix=function(e,t,s,r){var u;a.normalizeArgs(s,r,function(e,t){u=e,r=t}),c.validateArgs("listQueuesSegmentedWithPrefix",function(e){e.callback(r)});var i=o(!0,{},u),l=g.get();l.withQueryOption(f.COMP,"list").withQueryOption(f.MAX_RESULTS,i.maxResults).withQueryOption(f.INCLUDE,i.include).withQueryOption(f.PREFIX,e),a.objectIsNull(t)||l.withQueryOption(f.MARKER,t.nextMarker),i.requestLocationMode=a.getNextListingLocationMode(t);this.performRequest(l,null,i,function(e,t){if(e.listQueuesResult=null,!e.error){e.listQueuesResult={entries:null,continuationToken:null},e.listQueuesResult.entries=[];var s=[];e.response.body.EnumerationResults.Queues&&e.response.body.EnumerationResults.Queues.Queue&&(s=e.response.body.EnumerationResults.Queues.Queue,n.isArray(s)||(s=[s]),s.forEach(function(t){var s=E.parse(t);e.listQueuesResult.entries.push(s)}),e.response.body.EnumerationResults.NextMarker&&(e.listQueuesResult.continuationToken={nextMarker:null,targetLocation:null},e.listQueuesResult.continuationToken.nextMarker=e.response.body.EnumerationResults.NextMarker,e.listQueuesResult.continuationToken.targetLocation=e.targetLocation))}t(e,function(e){r(e.error,e.listQueuesResult,e.response)})})},r.prototype.doesQueueExist=function(e,t,s){this._doesQueueExist(e,!1,t,s)},r.prototype.createQueue=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("createQueue",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r),n=g.put(e);u&&n.addOptionalMetadataHeaders(u.metadata);this.performRequest(n,null,u,function(t,r){t.queueResult=null,t.error||(t.queueResult=new E(e),u&&u.metadata&&(t.queueResult.metadata=u.metadata));r(t,function(e){s(e.error,e.queueResult,e.response)})})},r.prototype.createQueueIfNotExists=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("createQueueIfNotExists",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r),n=this;n._doesQueueExist(e,!0,u,function(t,r,o){var i=r.exists;r.created=!1,delete r.exists,t?s(t,r,o):i?(o.isSuccessful=!0,s(t,r,o)):n.createQueue(e,u,function(e,t,r){e?e&&e.statusCode===d.HttpConstants.HttpResponseCodes.Conflict&&e.code===d.QueueErrorCodeStrings.QUEUE_ALREADY_EXISTS&&(e=null,t.created=!1,r.isSuccessful=!0):t.created=!0,s(e,t,r)})})},r.prototype.deleteQueue=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("deleteQueue",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r),n=g.del(e);this.performRequest(n,null,u,function(e,t){t(e,function(e){s(e.error,e.response)})})},r.prototype.deleteQueueIfExists=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("deleteQueueIfExists",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r),n=this;n._doesQueueExist(e,!0,u,function(t,r,o){t?s(t,r.exists,o):r.exists?n.deleteQueue(e,u,function(e,t){var r;e?e&&e.statusCode===d.HttpConstants.HttpResponseCodes.NotFound&&e.code===d.QueueErrorCodeStrings.QUEUE_NOT_FOUND&&(r=!1,e=null,t.isSuccessful=!0):r=!0,s(e,r,t)}):(o.isSuccessful=!0,s(t,!1,o))})},r.prototype.getQueueMetadata=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("getQueueMetadata",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r),n=g.get(e).withQueryOption(f.COMP,"metadata");u.requestLocationMode=d.RequestLocationMode.PRIMARY_OR_SECONDARY;var i=this;this.performRequest(n,null,u,function(t,r){t.queueResult=null,t.error||(t.queueResult=new E(e),t.queueResult.metadata=i.parseMetadataHeaders(t.response.headers),t.queueResult.getPropertiesFromHeaders(t.response.headers));r(t,function(e){s(e.error,e.queueResult,e.response)})})},r.prototype.setQueueMetadata=function(e,t,s,r){var u;a.normalizeArgs(s,r,function(e,t){u=e,r=t}),c.validateArgs("setQueueMetadata",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(r)});var n=o(!0,{},u),i=g.put(e).withQueryOption(f.COMP,"metadata").addOptionalMetadataHeaders(t);this.performRequest(i,null,n,function(s,u){s.queueResult=null,s.error||(s.queueResult=new E(e,t),s.queueResult.getPropertiesFromHeaders(s.response.headers));u(s,function(e){r(e.error,e.queueResult,e.response)})})},r.prototype.createMessage=function(e,t,r,u){var i;a.normalizeArgs(r,u,function(e,t){i=e,u=t}),c.validateArgs("createMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(u)});var l=R.serialize(t,this.messageEncoder),p=o(!0,{},i),d=g.post(e+"/messages").withHeader(m.CONTENT_TYPE,'application/atom+xml;charset="utf-8"').withHeader(m.CONTENT_LENGTH,s.byteLength(l,"utf8")).withQueryOption(f.MESSAGE_TTL,p.messageTimeToLive).withQueryOption(f.VISIBILITY_TIMEOUT,p.visibilityTimeout).withBody(l);this.performRequest(d,d.body,p,function(e,t){if(e.queueMessageResults=[],e.response&&e.response.body&&e.response.body.QueueMessagesList&&e.response.body.QueueMessagesList.QueueMessage){var s=e.response.body.QueueMessagesList.QueueMessage;n.isArray(s)||(s=[s]),s.forEach(function(t){var s=R.parse(t,this.messageEncoder);e.queueMessageResults.push(s)})}t(e,function(t){u(t.error,e.queueMessageResults[0],t.response)})})},r.prototype.getMessages=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("getMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r);delete u.peekOnly,this._getOrPeekMessages(e,u,s)},r.prototype.getMessage=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("getMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r);u.numOfMessages=1;this.getMessages(e,u,function(e,t,r){var u;t&&t.length>0&&(u=t[0]),s(e,u,r)})},r.prototype.peekMessages=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("peekMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r);u.peekOnly=!0,delete u.visibilityTimeout,this._getOrPeekMessages(e,u,s)},r.prototype.peekMessage=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("peekMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r);u.numOfMessages=1;this.peekMessages(e,u,function(e,t,r){var u;t&&t.length>0&&(u=t[0]),s(e,u,r)})},r.prototype.deleteMessage=function(e,t,s,r,u){var n;if(a.normalizeArgs(r,u,function(e,t){n=e,u=t}),c.validateArgs("deleteMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(u)}),a.objectIsNull(s))throw new Error(l.INVALID_POP_RECEIPT);if(a.objectIsNull(t))throw new Error(l.INVALID_MESSAGE_ID);var i=o(!0,{},n),p=g.del(e+"/messages/"+t).withQueryOption(f.POP_RECEIPT,s,null,!0);this.performRequest(p,null,i,function(e,t){t(e,function(e){u(e.error,e.response)})})},r.prototype.clearMessages=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("clearMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r),n=g.del(e+"/messages");this.performRequest(n,null,u,function(e,t){t(e,function(e){s(e.error,e.response)})})},r.prototype.updateMessage=function(e,t,r,u,n,i){var p;if(a.normalizeArgs(n,i,function(e,t){p=e,i=t}),c.validateArgs("updateMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(i)}),a.objectIsNull(r))throw new Error(l.INVALID_POP_RECEIPT);if(a.objectIsNull(t))throw new Error(l.INVALID_MESSAGE_ID);var d=o(!0,{},p),v=null;d.messageText&&(v=R.serialize(d.messageText,this.messageEncoder));var E=v?s.byteLength(v,"utf8"):0,q=g.put(e+"/messages/"+t).withHeader(m.CONTENT_TYPE,'application/atom+xml;charset="utf-8"').withHeader(m.CONTENT_LENGTH,E).withQueryOption(f.POP_RECEIPT,r,null,!0).withQueryOption(f.VISIBILITY_TIMEOUT,u).withBody(v);this.performRequest(q,q.body,d,function(s,r){s.queueMessageResult=null,s.error||(s.queueMessageResult=new R(e,t),s.queueMessageResult.getPropertiesFromHeaders(s.response.headers));r(s,function(e){i(e.error,e.queueMessageResult,e.response)})})},r.prototype.getQueueAcl=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("getQueueAcl",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r),n=g.get(e).withQueryOption(f.COMP,"acl");u.requestLocationMode=d.RequestLocationMode.PRIMARY_OR_SECONDARY;this.performRequest(n,null,u,function(t,r){t.queueResult=null,t.error||(t.queueResult=new E(e),t.queueResult.getPropertiesFromHeaders(t.response.headers),t.queueResult.signedIdentifiers=q.parse(t.response.body));r(t,function(e){s(e.error,e.queueResult,e.response)})})},r.prototype.setQueueAcl=function(e,t,r,u){var i;a.normalizeArgs(r,u,function(e,t){i=e,u=t}),c.validateArgs("setQueueAcl",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(u)});var p=o(!0,{},i),d=null;if(t){if(n.isArray(t))throw new TypeError(l.INVALID_SIGNED_IDENTIFIERS);d=q.serialize(t)}var v=g.put(e).withQueryOption(f.COMP,"acl").withHeader(m.CONTENT_LENGTH,a.objectIsNull(d)?0:s.byteLength(d)).withBody(d);this.performRequest(v,v.body,p,function(s,r){s.containerResult=null,s.error||(s.queueResult=new E(e),s.queueResult.getPropertiesFromHeaders(s.response.headers),t&&(s.queueResult.signedIdentifiers=t));r(s,function(e){u(e.error,e.queueResult,e.response)})})},r.prototype.generateSharedAccessSignature=function(e,t){if(!this.storageCredentials||!this.storageCredentials.generateSignedQueryString)throw new Error(l.CANNOT_CREATE_SAS_WITHOUT_ACCOUNT_KEY);return c.validateArgs("generateSharedAccessSignature",function(s){s.string(e,"queue"),s.queueNameIsValid(e),s.object(t,"sharedAccessPolicy")}),this.storageCredentials.generateSignedQueryString(d.ServiceType.Queue,e,t,null)},r.prototype._doesQueueExist=function(e,t,s,r){var u;a.normalizeArgs(s,r,function(e,t){u=e,r=t}),c.validateArgs("doesQueueExist",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(r)});var n=o(!0,{},u),i=g.head(e).withQueryOption(f.COMP,"metadata");!1===t&&(n.requestLocationMode=v.PRIMARY_OR_SECONDARY);this.performRequest(i,null,n,function(t,s){t.queueResult=new E(e),t.queueResult.exists=!1,t.error?t.error&&t.error.statusCode===d.HttpConstants.HttpResponseCodes.NotFound&&(t.error=null,t.queueResult.exists=!1,t.response.isSuccessful=!0):(t.queueResult.exists=!0,t.queueResult.getPropertiesFromHeaders(t.response.headers));s(t,function(e){r(e.error,e.queueResult,e.response)})})},r.prototype._getOrPeekMessages=function(e,t,s){var r;a.normalizeArgs(t,s,function(e,t){r=e,s=t}),c.validateArgs("_getOrPeekMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=o(!0,{},r);u.numOfMessages||(u.numOfMessages=1);var i=g.get(e+"/messages").withQueryOption(f.NUM_OF_MESSAGES,u.numOfMessages).withQueryOption(f.VISIBILITY_TIMEOUT,u.visibilityTimeout).withQueryOption(f.PEEK_ONLY,u.peekOnly);u.peekOnly&&(u.requestLocationMode=v.PRIMARY_OR_SECONDARY);var l=this.messageEncoder;this.performRequest(i,null,u,function(e,t){if(e.queueMessageResults=null,!e.error&&(e.queueMessageResults=[],e.response.body.QueueMessagesList&&e.response.body.QueueMessagesList.QueueMessage)){var r=e.response.body.QueueMessagesList.QueueMessage;n.isArray(r)||(r=[r]),r.forEach(function(t){var s=R.parse(t,l);e.queueMessageResults.push(s)})}t(e,function(e){s(e.error,e.queueMessageResults,e.response)})})},r.prototype.getUrl=function(e,t,s){return c.validateArgs("getUrl",function(t){t.string(e,"queue"),t.queueNameIsValid(e)}),this._getUrl(e,t,s)},t.exports=r}).call(this,e("buffer").Buffer)},{"./../../common/common.core":6,"./models/queuemessageresult":57,"./models/queueresult":58,"./queuemessageencoder":59,buffer:"buffer",extend:157,underscore:247,util:"util"}],58:[function(e,t,s){function r(e,t){e&&(this.name=e),t&&(this.metadata=t)}var u=e("./../../../common/common.core").Constants.HeaderConstants;r.parse=function(e){var t=new r;for(var s in e)e.hasOwnProperty(s)&&(t[s.toLowerCase()]=e[s]);return t},r.prototype.getPropertiesFromHeaders=function(e){var t=this;!function(s,r,u){!t[s]&&e[r.toLowerCase()]&&(t[s]=u?u(e[r.toLowerCase()]):e[r.toLowerCase()])}("approximateMessageCount",u.APPROXIMATE_MESSAGES_COUNT,parseInt)},t.exports=r},{"./../../../common/common.core":6}],57:[function(e,t,s){function r(e,t,s){e&&(this.queue=e),t&&(this.messageId=t),s&&(this.popReceipt=s)}var u=e("./../../../common/common.core"),n=u.util,o=u.xmlbuilder,i=u.Constants,a=i.HeaderConstants;r.serialize=function(e,t){var s=o.create();if(s=s.begin(i.QueueConstants.QUEUE_MESSAGE_ELEMENT,{version:"1.0",encoding:"utf-8"}),e){var r;r=null!==t&&void 0!==t?t.encode(e):e,s.ele(i.QueueConstants.MESSAGE_TEXT_ELEMENT).txt(r).up()}else s.ele(i.QueueConstants.MESSAGE_TEXT_ELEMENT).up();return s.doc().toString()},r.parse=function(e,t){var s=new r;for(var u in e)u===i.QueueConstants.MESSAGE_TEXT_ELEMENT?s.messageText=null!==t&&void 0!==t?t.decode(e[u]):e[u]:s[n.normalizePropertyNameFromXML(u)]=e[u];return s.dequeueCount&&(s.dequeueCount=parseInt(s.dequeueCount)),s},r.prototype.getPropertiesFromHeaders=function(e){var t=this,s=function(s,r){!t[s]&&e[r.toLowerCase()]&&(t[s]=e[r.toLowerCase()])};s("popReceipt",a.POP_RECEIPT),s("timeNextVisible",a.TIME_NEXT_VISIBLE)},t.exports=r},{"./../../../common/common.core":6}],59:[function(e,t,s){(function(s){function r(){}function u(){}function n(){}function o(){}var i=e("util");r.prototype.encode=function(e){return e},r.prototype.decode=function(e){return e},i.inherits(u,r),u.prototype.encode=function(e){return new s(e,"utf8").toString("base64")},u.prototype.decode=function(e){return new s(e,"base64").toString("utf8")},i.inherits(n,r),n.prototype.encode=function(e){return e.toString("base64")},n.prototype.decode=function(e){return new s(e,"base64")},i.inherits(o,r),o.prototype.encode=function(e){return e.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/'/gm,"&apos;")},o.prototype.decode=function(e){return e.replace(/&amp;/gm,"&").replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&quot;/gm,'"').replace(/&apos;/gm,"'")},t.exports=r,t.exports.TextBase64QueueMessageEncoder=u,t.exports.BinaryBase64QueueMessageEncoder=n,t.exports.TextXmlQueueMessageEncoder=o}).call(this,e("buffer").Buffer)},{buffer:"buffer",util:"util"}]},{},[3]);
